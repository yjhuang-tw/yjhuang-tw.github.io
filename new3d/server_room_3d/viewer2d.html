<!DOCTYPE html><html lang="en"><head><title>2D顯示機櫃 (DCIM)</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script><style>*{box-sizing:border-box}body{margin:0;font-family:Arial,Helvetica,sans-serif}.sidenav{height:100%;width:150px;position:fixed;z-index:1;top:0;left:0;background-color:#212529;overflow-x:hidden;padding:10px}.sidenav button{width:100%;margin-bottom:10px}.menu{margin:10px}.content{margin-left:150px}.cabinet-container{display:flex;flex-wrap:wrap}.cabinet-container>div{width:180px;margin-left:10px;margin-bottom:10px;font-size:10px}.item{line-height:12px}.col1{width:15px;text-align:center}.col2{text-align:center}.device{text-align:center}.device:hover{opacity:.5;border-color:#000000FF;cursor:pointer}.state-normal{color:#000;background-color:#0dcaf0}.state-warning{color:#000;background-color:#ffc107}.state-critical{color:#000;background-color:#dc3545}.group-g1{background-color:#3cb371}.group-g2{background-color:Violet}.group-g3{background-color:#6a5acd}.color-meaning{background-color:#e8e9ea;margin-left:10px;margin-bottom:10px;font-size:10px}.color-block{display:inline-block;border:1px solid;width:35px;margin:5px;border-color:#333}.color-block-out{display:inline-block;width:120px}.img-bg{color:#fff;border-color:#000}table{width:100%;border-collapse:separate;border-spacing:0;border-top:1px solid;border-left:1px solid}td{border:1px solid;border-top:none;border-left:none}</style></head><body><div class="sidenav"><button type="button" class="btn btn-outline-primary btn-sm">NCP</button><button type="button" class="btn btn-outline-primary btn-sm">NSP</button><button type="button" class="btn btn-outline-primary btn-sm">CRM</button><button type="button" class="btn btn-outline-primary btn-sm">ERP</button><button type="button" class="btn btn-outline-primary btn-sm">OSP</button><button type="button" class="btn btn-outline-primary btn-sm">Billing</button></div><div class="content"><div class="menu"><div class="btn-group btn-group-sm" role="group" aria-label="Basic radio toggle button group"><input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off" checked="checked"><label class="btn btn-outline-primary" for="btnradio1">Front view</label><input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off"><label class="btn btn-outline-primary" for="btnradio2">Rear view</label></div><div style="display:inline-flex"><select class="form-select form-select-sm" onchange="OnChangeSelectCol01(this)"><option value="None">None</option><option value="Groups">Groups</option></select></div><div style="display:inline-flex"><select class="form-select form-select-sm" onchange="OnChangeSelectCol02(this)"><option value="Images">Images</option><option value="Status">Status</option><option value="Types">Types</option></select></div><div style="display:inline-flex;margin-left:10px"><div class="form-check"><input class="form-check-input" type="checkbox" id="check1" name="option1" value="something" onclick="OnClickLabelsCheckbox(this)" checked="checked"><label class="form-check-label">Labels</label></div></div></div><div id="color-meaning-group" class="color-meaning" style="display:none"><div class="color-block-out"><div class="color-block group-g1">&nbsp;</div>Group 1</div><div class="color-block-out"><div class="color-block group-g2">&nbsp;</div>Group 2</div><div class="color-block-out"><div class="color-block group-g3">&nbsp;</div>Group 3</div></div><div id="color-meaning-state" class="color-meaning" style="display:none"><div class="color-block-out"><div class="color-block state-normal">&nbsp;</div>Normal</div><div class="color-block-out"><div class="color-block state-warning">&nbsp;</div>Warning</div><div class="color-block-out"><div class="color-block state-critical">&nbsp;</div>Critical</div></div><div id="cabinet-container" class="cabinet-container"></div></div></body><script>function OpenUrl(e){window.open(e,"","width=800,height=600,location=no,menubar=no,status=no,titlebar=no,top=50,left=100")}function OnChangeSelectCol01(e){$("#color-meaning-group").hide(),ClearInfoCol1(),"None"==e.value||"Groups"==e.value&&($("#color-meaning-group").show(),UpdateGroup())}function OnChangeSelectCol02(e){console.log(e.value),$("#color-meaning-state").hide(),ClearInfoCol2(),"Images"==e.value?UpdateImage():"Status"==e.value?($("#color-meaning-state").show(),UpdateState()):e.value}let devices=[];function UpdateState(){for(let e=0;e<devices.length;e++)devices[e].state==STATE.NORMAL?$(`#${devices[e].uuid}`).addClass("state-normal"):devices[e].state==STATE.WARNING?$(`#${devices[e].uuid}`).addClass("state-warning"):devices[e].state==STATE.CRITICAL&&$(`#${devices[e].uuid}`).addClass("state-critical")}function UpdateImage(){for(let e=0;e<devices.length;e++){let t=15*devices[e].numU;$(`#${devices[e].uuid}`).attr("style","background-image: url('assets/img/"+devices[e].img+"'); background-size: 164px "+t+"px;"),$(`#${devices[e].uuid}`).addClass("img-bg")}}function OnClickLabelsCheckbox(e){e.checked?UpdateLabelsOn():UpdateLabelsOff()}function UpdateLabelsOff(){for(let e=0;e<devices.length;e++)$(`#${devices[e].uuid}`).text("")}function UpdateLabelsOn(){for(let e=0;e<devices.length;e++)$(`#${devices[e].uuid}`).text(devices[e].label)}let cabinetUs=[];function UpdateGroup(){for(let e=0;e<cabinetUs.length;e++)cabinetUs[e].group==GROUP.G1?$(`#${cabinetUs[e].uuid}`).addClass("group-g1"):cabinetUs[e].group==GROUP.G2?$(`#${cabinetUs[e].uuid}`).addClass("group-g2"):cabinetUs[e].group==GROUP.G3&&$(`#${cabinetUs[e].uuid}`).addClass("group-g3")}function ClearInfoCol1(){for(let e=0;e<cabinetUs.length;e++)$(`#${cabinetUs[e].uuid}`).removeClass(),$(`#${cabinetUs[e].uuid}`).addClass("col1")}function ClearInfoCol2(){for(let e=0;e<devices.length;e++)$(`#${devices[e].uuid}`).removeClass(),$(`#${devices[e].uuid}`).attr("style",""),$(`#${devices[e].uuid}`).addClass("device")}const STATE={NONE:-1,NORMAL:0,WARNING:1,CRITICAL:2},GROUP={NONE:-1,G1:0,G2:1,G3:2,G4:3},devices_tmp=[{label:"IDC-OME01",numU:1,state:STATE.NORMAL,img:"img1_1u.png",url:"https://www.google.com.tw/"},{label:"IDC-PDPSTAG",numU:2,state:STATE.WARNING,img:"img2_2u.png",url:"https://www.google.com.tw/"},{label:"N-A19-CRT螢幕",numU:9,state:STATE.NORMAL,img:"img3_9u.png",url:"https://www.google.com.tw/"},{label:"N-A19-1U層板",numU:1,state:STATE.NORMAL,img:"img4_1u.png",url:"https://www.google.com.tw/"},{label:"N-A19-KVM切換器",numU:2,state:STATE.WARNING,img:"img5_2u.png",url:"https://www.google.com.tw/"},{label:"IDC-IMGSTOR02",numU:2,state:STATE.NORMAL,img:"img6_2u.png",url:"https://www.google.com.tw/"},{label:"IDC-RENFS01P",numU:2,state:STATE.NORMAL,img:"img7_2u.png",url:"https://www.google.com.tw/"},{label:"IDC-RENDB02P",numU:2,state:STATE.WARNING,img:"img8_2u.png",url:"https://www.google.com.tw/"},{label:"IDC-RENDB03P",numU:2,state:STATE.NORMAL,img:"img9_2u.png",url:"https://www.google.com.tw/"},{label:"MIS-II-AP1",numU:2,state:STATE.NONE,img:"img10_2u.png",url:"https://www.google.com.tw/"},{label:"IDC-OMA02P",numU:2,state:STATE.CRITICAL,img:"img11_2u.png",url:"https://www.google.com.tw/"}];let devices500=[];for(let e=0;e<500;e++){let t=Math.floor(Math.random()*(Math.floor(11)-Math.ceil(0))+Math.ceil(0)),a=JSON.parse(JSON.stringify(devices_tmp[t]));a.uuid="u"+e,devices500.push(a)}let max_size_cabinet=42,cnt=0;for(let e=0;e<21;e++){let t=Math.floor(Math.random()*(Math.floor(43)-Math.ceil(39))+Math.ceil(39)),a=t,l=[];for(;a>0;){let e=cnt,t=[a,e];l[l.length]=t,cnt++,a-=devices500[e].numU,a-=Math.floor(Math.random()*(Math.floor(3)-Math.ceil(0))+Math.ceil(0))}l.pop();let s=$("<table>").addClass("mytable");if(t<max_size_cabinet){let e=$("<tr>").addClass("item"),a=$("<td>").attr("colspan",2);a.attr("height",15*(max_size_cabinet-t)),e.append(a),s.append(e)}let i,n,o=0;for(let a=t;a>0;a--)if(o<l.length&&a==l[o][0]){const t=devices500[l[o][1]];devices.push(t),i="C"+e+"_"+a,n={uuid:i,group:GROUP.G1},cabinetUs.push(n);let d=$("<tr>").addClass("item"),u=$("<td>").addClass("col1").text(a);u.attr("id",i);let c=$("<td>").addClass("device").text(t.label);c.attr("id",t.uuid),c.attr("onclick","OpenUrl('"+t.url+"');"),t.numU>1&&c.attr("rowspan",t.numU),d.append(u),d.append(c),s.append(d);for(let l=1;l<t.numU;l++){a--,i="C"+e+"_"+a,n={uuid:i,group:GROUP.G1},cabinetUs.push(n);let t=$("<tr>").addClass("item"),l=$("<td>").addClass("col1").text(a);l.attr("id",i),t.append(l),s.append(t)}o++}else{i="C"+e+"_"+a,n={uuid:i,group:GROUP.G2},cabinetUs.push(n);let t=$("<tr>").addClass("item"),l=$("<td>").addClass("col1").text(a);l.attr("id",i);let o=$("<td>").addClass("col2");t.append(l),t.append(o),s.append(t)}let d=$("<div>").addClass("mydevice").text("A"+e);d.append(s),$("#cabinet-container").append(d)}console.log(cabinetUs),UpdateImage()</script></html>